# FPGAå®Ÿæ©Ÿã§ã®REG_TEST_0ã€œ3ãƒ¬ã‚¸ã‚¹ã‚¿æ¤œè¨¼

## æ¦‚è¦
UVMã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§æ¤œè¨¼æ¸ˆã¿ã®REG_TEST_0ã€œ3ãƒ¬ã‚¸ã‚¹ã‚¿ã®å‹•ä½œã‚’FPGAå®Ÿæ©Ÿã§æ¤œè¨¼ã™ã‚‹ãŸã‚ã®Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚

## æ¤œè¨¼å†…å®¹
UVMãƒ†ã‚¹ãƒˆã§å®Ÿè¡Œã•ã‚ŒãŸ13ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ†ã‚¹ãƒˆã‚’FPGAå®Ÿæ©Ÿã§å†ç¾ï¼š

1. **åˆæœŸå€¤ç¢ºèª**: ãƒªã‚»ãƒƒãƒˆå¾Œã®åˆæœŸå€¤æ¤œè¨¼
2. **å…¨ãƒ“ãƒƒãƒˆæ›¸ãè¾¼ã¿**: 0xFFFFFFFFãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ
3. **ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°1ãƒ“ãƒƒãƒˆ**: å„ãƒ“ãƒƒãƒˆä½ç½®ã®ç‹¬ç«‹æ€§ç¢ºèª
4. **ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°0ãƒ“ãƒƒãƒˆ**: åè»¢ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ
5. **å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ**: æœ€å°/æœ€å¤§å€¤ãƒ†ã‚¹ãƒˆ
6. **ãƒ©ãƒ³ãƒ€ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³**: ç–‘ä¼¼ãƒ©ãƒ³ãƒ€ãƒ å€¤ãƒ†ã‚¹ãƒˆ
7. **æœ€çµ‚çŠ¶æ…‹ç¢ºèª**: å‹•ä½œç¢ºèªå¾Œã®çŠ¶æ…‹ãƒ†ã‚¹ãƒˆ

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### 1. `test_reg_test_fpga.py` (åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ)
- UVMãƒ†ã‚¹ãƒˆã¨åŒç­‰ã®å®Œå…¨ãªæ¤œè¨¼
- 13ãƒ‘ã‚¿ãƒ¼ãƒ³ Ã— 4ãƒ¬ã‚¸ã‚¹ã‚¿ = ç´„300ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- è©³ç´°ãªãƒ­ã‚°å‡ºåŠ›ã¨ãƒ†ã‚¹ãƒˆçµ±è¨ˆ

### 2. `test_reg_test_simple.py` (åŸºæœ¬ãƒ†ã‚¹ãƒˆ)
- ç°¡æ˜“çš„ãªèª­ã¿æ›¸ãå‹•ä½œç¢ºèª
- å„ãƒ¬ã‚¸ã‚¹ã‚¿ã§åŸºæœ¬çš„ãªæ›¸ãè¾¼ã¿/èª­ã¿æˆ»ã—ãƒ†ã‚¹ãƒˆ
- çŸ­æ™‚é–“ã§ã®å‹•ä½œç¢ºèªç”¨

## å®Ÿè¡Œç’°å¢ƒ

### å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª
```bash
pip install pyserial
```

### FPGAæ¥ç¶š
- **UARTæ¥ç¶š**: COM3ãƒãƒ¼ãƒˆ (115200 baud)
- **FPGAè¨­å®š**: REG_TEST_0ã€œ3ãƒ¬ã‚¸ã‚¹ã‚¿ãŒæœ‰åŠ¹åŒ–æ¸ˆã¿
- **ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹**: 0x00001000

## ãƒ¬ã‚¸ã‚¹ã‚¿ã‚¢ãƒ‰ãƒ¬ã‚¹
```
REG_TEST_0: 0x00001020  (åˆæœŸå€¤: 0xDEADBEEF)
REG_TEST_1: 0x00001024  (åˆæœŸå€¤: 0x12345678)  
REG_TEST_2: 0x00001028  (åˆæœŸå€¤: 0xABCDEF00)
REG_TEST_3: 0x0000102C  (åˆæœŸå€¤: 0x00000000)
```

## å®Ÿè¡Œæ–¹æ³•

### åŸºæœ¬ãƒ†ã‚¹ãƒˆ (æ¨å¥¨)
```bash
cd E:\Nautilus\workspace\fpgawork\AXIUART_\software
python test_reg_test_simple.py
```

### åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ
```bash
cd E:\Nautilus\workspace\fpgawork\AXIUART_\software
python test_reg_test_fpga.py
```

## æœŸå¾…ã•ã‚Œã‚‹çµæœ

### æˆåŠŸä¾‹
```
ğŸ”¬ FPGA REG_TEST Simple Verification
ğŸ¯ Basic read/write functionality test
==================================================
âœ… Connected to COM3

ğŸ§ª REG_TEST_0ã€œ3 åŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆ
==================================================

ğŸ“ Testing REG_TEST_0 (0x00001020)
------------------------------
  Initial value: 0xDEADBEEF
  Writing: 0x12345678
  âœ… Write successful
  âœ… Read-back OK: 0x12345678
  Writing: 0xDEADBEEF
  âœ… Second test OK: 0xDEADBEEF

[REG_TEST_1ã€œ3ã§ã‚‚åŒæ§˜ã®æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]

==================================================
ğŸ‰ All basic tests PASSED!
âœ… REG_TEST_0ã€œ3 registers are working correctly
==================================================
```

## UVMãƒ†ã‚¹ãƒˆçµæœã¨ã®å¯¾ç…§

### UVMã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ
- **ç·ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³**: 76ä»¶
- **æˆåŠŸç‡**: 100% (76/76)
- **ã‚¨ãƒ©ãƒ¼**: 0ä»¶
- **æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³**: 13ç¨®é¡

### FPGAå®Ÿæ©Ÿã§ã®æœŸå¾…çµæœ
- **åŸºæœ¬ãƒ†ã‚¹ãƒˆ**: 4ãƒ¬ã‚¸ã‚¹ã‚¿ Ã— 2å› = 8å›ã®ãƒ†ã‚¹ãƒˆ
- **åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ**: 13ãƒ‘ã‚¿ãƒ¼ãƒ³ Ã— 4ãƒ¬ã‚¸ã‚¹ã‚¿ = ç´„300å›ã®ãƒ†ã‚¹ãƒˆ
- **æœŸå¾…æˆåŠŸç‡**: 100%

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### æ¥ç¶šã‚¨ãƒ©ãƒ¼
```
âŒ Connection failed: [Errno 2] could not open port 'COM3'
```
**å¯¾å‡¦æ³•**: 
- COMãƒãƒ¼ãƒˆç•ªå·ã‚’ç¢ºèª
- FPGAãƒœãƒ¼ãƒ‰ãŒUSBæ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ‡ãƒã‚¤ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ãƒãƒ¼ãƒˆçŠ¶æ…‹ç¢ºèª

### é€šä¿¡ã‚¨ãƒ©ãƒ¼
```
âŒ No response received
```
**å¯¾å‡¦æ³•**:
- FPGAè¨­å®šã‚’ç¢ºèªï¼ˆãƒœãƒ¼ãƒ¬ãƒ¼ãƒˆã€ãƒ‘ãƒªãƒ†ã‚£ç­‰ï¼‰
- UARTãƒ–ãƒªãƒƒã‚¸ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ã‚±ãƒ¼ãƒ–ãƒ«æ¥ç¶šã‚’ç¢ºèª

### ãƒ¬ã‚¸ã‚¹ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼
```
âŒ Read-back failed: expected 0x12345678, got 0x00000000
```
**å¯¾å‡¦æ³•**:
- FPGAã®ã‚¯ãƒ­ãƒƒã‚¯ä¾›çµ¦ã‚’ç¢ºèª
- ãƒªã‚»ãƒƒãƒˆä¿¡å·ãŒé©åˆ‡ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ¬ã‚¸ã‚¹ã‚¿ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ç¢ºèª

## ãƒ—ãƒ­ãƒˆã‚³ãƒ«è©³ç´°

### UARTãƒ•ãƒ¬ãƒ¼ãƒ å½¢å¼
**æ›¸ãè¾¼ã¿ã‚³ãƒãƒ³ãƒ‰**:
```
[SOF:0xA5][CMD:0x20][ADDR:4byte][DATA:4byte][CRC:1byte]
```

**èª­ã¿å‡ºã—ã‚³ãƒãƒ³ãƒ‰**:
```
[SOF:0xA5][CMD:0xA0][ADDR:4byte][CRC:1byte]
```

**å¿œç­”ãƒ•ãƒ¬ãƒ¼ãƒ **:
```
[SOF:0x5A][STATUS:0x00][CMD_ECHO][DATA:4byte][CRC:1byte]
```

### æˆåŠŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
- **STATUS**: 0x00 (æ­£å¸¸çµ‚äº†)
- **SOF**: 0x5A (ãƒ‡ãƒã‚¤ã‚¹â†’ãƒ›ã‚¹ãƒˆ)

## å‚è€ƒæƒ…å ±

### UVMãƒ†ã‚¹ãƒˆãƒ­ã‚°æŠœç²‹
```
DEBUG: test_reg_3 write: data=0x80000000, old_value=0x40000000
DEBUG: test_reg_3 UPDATED: write_data=0x80000000 -> new_value=0x80000000
UVM_INFO: SCOREBOARD Matches found: 76
UVM_INFO: SCOREBOARD Mismatches found: 0
```

ã“ã®çµæœã‚’FPGAå®Ÿæ©Ÿã§ã‚‚å†ç¾ã™ã‚‹ã“ã¨ãŒç›®æ¨™ã§ã™ã€‚