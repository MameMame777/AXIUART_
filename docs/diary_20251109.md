# 2025-11-09 Diary

## REG_TEST Multi-Pattern Coverage Expansion

### Scope – Multi-Pattern Coverage

- Implement comprehensive read/write stimulus across `REG_TEST_0`–`REG_TEST_7` using required data patterns (0x5555, 0xAAAA, 0xFFFF).
- Validate sequence build and initiate regression run through FastMCP workflow.

### Activities – Multi-Pattern Coverage

- Reworked `sim/uvm/sequences/test_reg_rw_sequence.sv` to iterate eight register addresses and three stress patterns with strict response/mismatch checks.
- Started FastMCP server task, executed `check_dsim_environment`, and enumerated available tests to confirm infrastructure health.
- Compiled `uart_axi4_basic_test_reg_rw` via MCP (`run_uvm_simulation --mode compile`) to validate syntax after stimulus changes.
- First runtime attempt hit `BASIC_TEST_TIMEOUT` (sequence exceeded legacy watchdog) yielding log `sim/exec/logs/uart_axi4_basic_test_reg_rw_20251109_082351.log`; extended frame timeout in `sim/uvm/tests/uart_axi4_basic_test_reg_rw.sv` to `cfg.byte_time_ns * 512` to accommodate full sweep.
- Recompiled the test and re-queued full DSIM run; license contention reoccurred (exit 105, log `sim/exec/logs/uart_axi4_basic_test_reg_rw_20251109_083348.log`).

### Results – Multi-Pattern Coverage

- Initial run exposed insufficient timeout coverage (UVM_FATAL `BASIC_TEST_TIMEOUT`), prompting configuration fix.
- Subsequent execution remains blocked by DSIM license lease exhaustion; awaiting clean run for functional validation.

### Follow-Up – Multi-Pattern Coverage

- Re-execute `run_uvm_simulation --mode run` once DSIM license availability is restored and archive resulting telemetry/waveforms.
- Review UART driver watchdog/timeout tuning post-run to ensure no regression in long-pattern scenarios.
- Extend scoreboard coverage expectations to consume the expanded register/pattern matrix after successful run.

---

## TEST_REG Read/Write Integration Prep

### Scope – Integration Prep

- Resume TEST_REG read/write validation work after branching from `main`.
- Restore stashed edits across RTL and UVM components without regressing prior fixes.
- Stage new regression sequence and basic test variants for future simulations.

### Activities – Integration Prep

- Applied stashed changes onto `feature/test-reg-rw-main` and resolved merge conflicts in `rtl/Uart_Axi4_Bridge.sv`, `sim/uvm/agents/uart/uart_driver.sv`, and package/test scaffolding.
- Reintroduced dynamic baud control plumbing (bridge/driver) and flattened AXI write data for waveform visibility in `rtl/Axi4_Lite_Master.sv`.
- Registered `uart_configure_baud_sequence`, `test_reg_rw_sequence`, and `uart_axi4_basic_test_reg_rw` within `uart_axi4_test_pkg.sv` and staged associated source files.
- Curated workspace by purging stray DSIM log artifacts from `sim/exec/logs/`.

### Follow-Up – Integration Prep

- Re-verify staged files against original design notes in `docs/` before finalizing TEST_REG coverage strategy.
- Compile and run `uart_axi4_basic_test_reg_rw` via MCP workflow to confirm end-to-end functionality.
- Extend scoreboard expectations to cover TEST_REG readback once DUT behaviour is validated.

---

## Emergency Diagnostics Regression

### Scope – Emergency Diagnostics

- Validate that emergency frame parser diagnostics no longer emit false warnings during idle periods.
- Confirm TEST_REG read/write scenario still passes after assertion update.

### Activities – Emergency Diagnostics

- Adjusted `state_eventually_advances` property in `sim/emergency_frame_parser_diagnostics.sv` to gate evaluations on active (non-IDLE) states and use `$stable(state)` checks.
- Re-ran `uart_axi4_basic_test_reg_rw` through FastMCP (`run_uvm_simulation`, `UVM_MEDIUM`) with waveform capture enabled.
- Archived DSIM outputs under `sim/exec/logs/uart_axi4_basic_test_reg_rw_20251109_080950.log` and `archive/waveforms/uart_axi4_basic_test_reg_rw_20251109_080950.mxd`.

### Results – Emergency Diagnostics

- Test PASSED with 0 UVM errors/fatals; `[EMERGENCY_FP]` warnings eliminated.
- Scoreboard reported perfect transaction correlation; coverage unchanged at 35.89% (below target 80%).

### Follow-Up – Emergency Diagnostics

- Plan expanded stimulus to raise coverage metrics in later tasks.
- Investigate `[BRIDGE_DEBUG][WARNING]` messages noting parser/MAIN_IDLE sequencing to determine if additional synchronization fences are required.

---

## TEST_REG Reduced Sweep Validation

### Scope – Focused Register Check

- Execute DSIM full run after constraining `test_reg_rw_sequence` to `REG_TEST_0` and `REG_TEST_1`.
- Confirm scoreboard alignment and absence of prior high-address warnings.
- Capture updated waveform and log artifacts for traceability.

### Activities – Focused Register Check

- Updated sequence constants (`NUM_REGISTERS=2`) in `sim/uvm/sequences/test_reg_rw_sequence.sv` per user directive.
- Launched FastMCP run: `python mcp_server/mcp_client.py --workspace e:\\Nautilus\\workspace\\fpgawork\\AXIUART_ --tool run_uvm_simulation --test-name uart_axi4_basic_test_reg_rw --mode run --verbosity UVM_MEDIUM --waves --timeout 600`.
- Monitored console output to verify transaction ordering and scoreboard responses during execution.

### Results – Focused Register Check

- Simulation completed without UVM errors or scoreboard mismatches; 12/12 transactions matched.
- MXD waveform dumped to `archive/waveforms/uart_axi4_basic_test_reg_rw_20251109_091452.mxd`.
- Coverage remained at 35.89%, triggering configured warning (expected with reduced stimulus scope).

### Follow-Up – Focused Register Check

- Plan incremental reintroduction of additional registers once scoreboard expectations are updated for the extended map.
- Consider temporary adjustment of coverage threshold or targeted covergroups to avoid noise while scope is intentionally constrained.

---

## Bus Protocol Documentation Refresh

### Scope – UART⇔AXI Bus Description

- Capture the production bus protocol so firmware and verification teams share a single reference for framing, command encoding, and acknowledgement rules.
- Address user request to clarify write acknowledgements and driver expectations around response handling.

### Activities – UART⇔AXI Bus Description

- Surveyed RTL sources (`Frame_Parser`, `Frame_Builder`, `Uart_Axi4_Bridge`, `Axi4_Lite_Master`) and UVM transaction classes to confirm field ordering, CRC coverage, and status code usage.
- Authored `docs/axiuart_bus_protocol.md` detailing transport characteristics, host/device frame formats, command byte layout, status table, and driver requirements.
- Documented auto-increment semantics and response behaviour for both success and error cases so software can implement deterministic parsing.

### Results – UART⇔AXI Bus Description

- New protocol specification published; satisfies immediate need to explain write ACK frames and provides a durable reference for future tooling updates.
- No RTL or UVM code changes required; documentation now aligns with observed DSIM run confirming write ACK (`5A 00 20 E0`) behaviour.

### Follow-Up – UART⇔AXI Bus Description

- Circulate the specification to firmware stakeholders and integrate citations into driver README artefacts.
- Add protocol conformance checks (e.g., scoreboard assertions) referencing the new document in a subsequent verification task.
