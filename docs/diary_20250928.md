# AXIUART Verification Diary – 2025-09-28

## Summary

- Investigated the persistent `Test timeout - simulation ran too long` failure seen after the UART monitor fixes.
- Determined that the 120 ms guard in `uart_axi4_tb_top` underestimated the execution time for long UART register campaigns at 115200 baud.
- Raised the simulation guard to a derived 400 ms window so the comprehensive register sequence can complete while preserving a deterministic stop condition.
- Re-ran the official regression flow via `run_uvm.ps1` (seed 12345) and confirmed the timeout UVM error is cleared.

## Root Cause Analysis

- Each UART frame serialises at 10 bits per byte, yielding ~86.8 µs per byte at 115200 baud.
- The comprehensive register sequence issues up to 175 UART transactions, including 23-byte burst writes and their responses.
- Worst-case runtime therefore exceeds 150 ms; the 120 ms guard clipped the run despite the DUT responding correctly.
- No missing responses were observed in the latest `dsim.log`; status frames (0x00/0x04/0x05) arrive with valid CRCs, so the failure was purely the external timeout condition.

## Implementation Details

- Added `localparam time SIM_TIMEOUT = 400ms;` to `sim/uvm/tb/uart_axi4_tb_top.sv` and reused it in the timeout block.
- Updated the timeout message to report the configured limit, improving post-mortem clarity.
- Chosen value covers the theoretical maximum (~320 ms for the current workload) with additional margin while avoiding indefinite simulations.

## Verification

- Command: `run_uvm.ps1 -TestName register_comprehensive_test -Seed 12345` (executed from `sim/uvm`).
- Result: exit code 0, `UVM_ERROR: 0`, wall-clock 56.03 s; simulation finished at 321.50015 ms without hitting the guard.
- Coverage summary from the run: frame 52.08 %, burst 46.88 %, error 100.00 %, total 66.32 % (warning retained for future coverage work).
- Scoreboard still flags unmatched UART transactions because the internal AXI monitor is passive; behaviour unchanged from prior runs and outside the current fix scope.

## Follow-up Recommendations

- Revisit scoreboard/AXI monitoring to eliminate the "Unmatched transactions remain" warning when internal AXI visibility becomes available.
- Consider scripting a dynamic timeout that scales with configured baud rate and expected transaction count for future scalability.
