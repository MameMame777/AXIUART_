# FPGA実機接続デバッグ手順書

**日付**: 2025年10月4日  
**対象**: COM3接続のFPGA実機  
**目的**: AXIUART Driver GUIによる実機通信テスト・デバッグ

## 🎯 デバッグ手順

### Phase 1: 基本接続確認

#### Step 1: 接続テスト
```
1. GUIのConnectionタブを開く
2. COM Portで "COM3" を選択
3. Baudrate: 115200 (デフォルト)
4. RTS/CTS Hardware Flow Control: チェック
5. "Connect" ボタンクリック
```

**期待結果**: 
- Status: "Connected to COM3 (115200 baud)" (緑色)
- RTS/CTS信号状態の表示

#### Step 2: 基本応答確認
```
Registers タブで以下を実行:
1. VERSION レジスタ読み取り
   - Register: "VERSION (0x101C)"
   - Data Width: 32
   - "Read" ボタンクリック
```

**期待結果**: 
- FPGAからのバージョン情報取得
- エラー無く値が表示される

### Phase 2: レジスタアクセステスト

#### Step 3: ステータス確認
```
1. STATUS レジスタ読み取り (0x1004)
2. CONTROL レジスタ読み取り (0x1000)  
3. CONFIG レジスタ読み取り (0x1008)
```

#### Step 4: ブリッジ制御テスト
```
1. "Enable Bridge" ボタンクリック
2. STATUS レジスタを再読み取り
3. ブリッジ状態変化の確認
```

### Phase 3: 任意メモリアクセステスト

#### Step 5: 新機能テスト
```
Memory タブで以下を実行:
1. Direct Memory Access:
   - Address: 1000 (CONTROL)
   - Data Width: 32
   - "Read" ボタンで読み取り確認

2. 任意アドレステスト:
   - Address: 2000 (任意)
   - "Read" ボタンで応答確認
```

### Phase 4: 通信解析

#### Step 6: エラー解析
```
Logs タブで以下を確認:
- 通信ログの詳細確認
- エラーメッセージの解析
- タイムスタンプ付き操作履歴

Status タブで統計確認:
- Commands Sent/Successful Responses
- CRC Errors/Timeout Errors
```

## 🔍 トラブルシューティング

### 接続失敗時
- **症状**: "Failed to connect" エラー
- **対策**: 
  1. COMポート番号確認
  2. FPGA電源確認
  3. USB/シリアルケーブル確認
  4. 他のアプリケーションでのポート使用確認

### 通信エラー時
- **症状**: レジスタ読み取り失敗
- **対策**:
  1. ボーレート設定確認 (115200)
  2. フロー制御設定確認 (RTS/CTS)
  3. FPGA側UARTモジュール動作確認

### CRCエラー時
- **症状**: CRC verification failed
- **対策**:
  1. 通信ノイズ確認
  2. ケーブル品質確認
  3. ボーレート調整 (38400, 57600で試行)

## 📊 デバッグ情報収集

### 必須確認項目
```
✓ 接続状態: Connected/Disconnected
✓ 信号状態: RTS/CTS/DSR/DTR
✓ 通信統計: 成功率、エラー率
✓ 応答時間: レジスタアクセス時間
✓ データ整合性: Write & Verify結果
```

### ログ記録項目
```
✓ 全操作のタイムスタンプ
✓ 送受信データの16進ダンプ
✓ エラー詳細とスタックトレース
✓ 統計情報の推移
```

## 🚀 実用テストケース

### テストケース1: 基本動作確認
```
1. VERSION読み取り → バージョン情報確認
2. STATUS読み取り → 初期状態確認  
3. ブリッジ有効化 → 制御機能確認
4. STATUS再読み取り → 状態変化確認
```

### テストケース2: 任意アドレステスト
```
1. 0x1000-0x101C の全レジスタ読み取り
2. 0x2000番台への書き込み・読み返し
3. バルク読み取り (0x1000から8ワード)
4. メモリテスト (0x3000で4ワード)
```

### テストケース3: エラー条件テスト
```
1. 存在しないアドレス (0xFFFF) への読み取り
2. 不正なデータ幅での操作
3. 意図的なCRCエラー生成
4. タイムアウト条件の確認
```

現在GUIが起動していますので、上記手順に従ってFPGA実機との通信テストを開始してください。まずはConnectionタブでCOM3への接続を試してみてください！

何かエラーや予期しない動作があれば、詳細を教えてください。ログの内容も確認できます。